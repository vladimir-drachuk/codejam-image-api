!function(t){var e={};function o(a){if(e[a])return e[a].exports;var l=e[a]={i:a,l:!1,exports:{}};return t[a].call(l.exports,l,l.exports,o),l.l=!0,l.exports}o.m=t,o.c=e,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)o.d(a,l,function(e){return t[e]}.bind(null,l));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){t.exports=o(2)},function(t,e){t.exports={getCoordinats:function(t,e,o){if("number"!=typeof t||"number"!=typeof e||Number.isNaN(t)||Number.isNaN(e))throw new TypeError("insert correct values.");return`X = ${Math.floor(t/o)} / Y = ${Math.floor(e/o)}`}}},function(t,e,o){"use strict";o.r(e);o(3);const{getCoordinats:a}=o(1),l=document.getElementById("canvas"),s=l.getContext("2d"),r=document.querySelector(".table-choose-list"),n=document.querySelector(".color-choose-list"),c=document.querySelector(".size-choose-list"),i=document.querySelector(".table__item_rnd_curr"),g=document.querySelector(".table__item_rnd_prev"),u=document.querySelector(".paint-bucket"),d=document.querySelector(".choose-color"),m=document.querySelector(".pensil"),h=document.querySelector(".input-color"),f=document.querySelector(".label-color"),v=r.querySelectorAll(".choose-item-tool"),S=c.querySelectorAll(".size-choose-list__item"),I=document.querySelector(".coordinats"),{body:b}=document,p=1;let L,y,$,w=!1,C=!1,_=[],k=[];function E(){s.fillStyle="white",s.fillRect(0,0,l.width,l.height),localStorage.setItem("canvas",l.toDataURL()),localStorage.setItem("graduate","false")}function x(){if(null===localStorage.getItem("canvas"))return void E();const t=localStorage.getItem("canvas"),e=new Image;e.src=t,e.onload=()=>{s.drawImage(e,0,0,l.width,l.height)}}function q(t,e){return!(t>+l.width||t<0||e>+l.height||e<0)}function M(t){if(w){const e=Math.floor(t.offsetX/$),o=Math.floor(t.offsetY/$);_=localStorage.getItem("color").split(","),s.fillStyle=`rgb(${_[0]}, ${_[1]}, ${_[2]})`;const a=Math.abs(e-L),l=Math.abs(o-y),r=L<e?1:-1,n=y<o?1:-1;let c=a-l;for(;L!==e||y!==o;){s.fillRect(L,y,p,p);const t=2*c;t>-l&&(c-=l,L+=r),t<a&&(c+=a,y+=n)}}}function D(t){w=!0;const e=Math.floor(t.offsetX/$),o=Math.floor(t.offsetY/$);s.beginPath(),_=localStorage.getItem("color").split(","),s.fillStyle=`rgb(${_[0]}, ${_[1]}, ${_[2]})`,s.fillRect(e,o,p,p),L=e,y=o,localStorage.setItem("graduate","true")}function z(t){if(C){const e=Math.floor(t.offsetX/$),o=Math.floor(t.offsetY/$),a=s.getImageData(e,o,1,1);a.data.toString()!==localStorage.getItem("color")&&(localStorage.setItem("prevColor",localStorage.getItem("color")),localStorage.setItem("color",a.data),_=localStorage.getItem("color").split(","),k=localStorage.getItem("prevColor").split(","),"0"===_[3]&&(_.splice(0,4,"255","255","255","255"),localStorage.setItem("color",_)),i.style.backgroundColor=`rgb(${_[0]}, ${_[1]}, ${_[2]})`,g.style.backgroundColor=`rgb(${k[0]}, ${k[1]}, ${k[2]})`)}}function P(){localStorage.setItem("prevColor",localStorage.getItem("color")),localStorage.setItem("color",_),k=localStorage.getItem("prevColor").split(","),i.style.backgroundColor=`rgb(${_[0]}, ${_[1]}, ${_[2]})`,g.style.backgroundColor=`rgb(${k[0]}, ${k[1]}, ${k[2]})`}function R(t){const e=Math.floor(t.offsetX/$),o=Math.floor(t.offsetY/$),a=s.getImageData(e,o,1,1);_=localStorage.getItem("color").split(","),s.fillStyle=`rgb(${_[0]}, ${_[1]}, ${_[2]})`,s.strokeStyle=`rgb(${_[0]}, ${_[1]}, ${_[2]})`,s.fillStyle=`rgb(${_[0]},${_[1]},${_[2]})`,function(t,e,o,a){const l=[];if(l.push([t,e]),s.getImageData(l[0][0],l[0][1],1,1).data.toString()!==a)for(;0!==l.length;){const t=l[0];s.getImageData(t[0],t[1],1,1).data.toString()===o&&q(t[0],t[1])&&s.fillRect(t[0],t[1],1,1),l.shift(),s.getImageData(t[0]+1,t[1],1,1).data.toString()===o&&q(t[0]+1,t[1])&&(s.fillRect(t[0]+1,t[1],1,1),l.push([t[0]+1,t[1]])),s.getImageData(t[0]-1,t[1],1,1).data.toString()===o&&q(t[0]-1,t[1])&&(s.fillRect(t[0]-1,t[1],1,1),l.push([t[0]-1,t[1]])),s.getImageData(t[0],t[1]+1,1,1).data.toString()===o&&q(t[0],t[1]+1)&&(s.fillRect(t[0],t[1]+1,1,1),l.push([t[0],t[1]+1])),s.getImageData(t[0],t[1]-1,1,1).data.toString()===o&&q(t[0],t[1]-1)&&(s.fillRect(t[0],t[1]-1,1,1),l.push([t[0],t[1]-1]))}}(e,o,a.data.toString(),localStorage.getItem("color")),localStorage.setItem("graduate","true")}function j(){const t=parseInt(h.value[1]+h.value[2],16),e=parseInt(h.value[3]+h.value[4],16),o=parseInt(h.value[5]+h.value[6],16);localStorage.getItem("color")!==`${t},${e},${o},255`&&(_[0]=t,_[1]=e,_[2]=o,_[3]="255",P(),f.style.backgroundColor=`rgb(${t},${e},${o})`)}function O(t,e){localStorage.setItem("canvas",l.toDataURL()),l.height=e,l.width=e,$=t,localStorage.setItem("sizeWidth",l.width),localStorage.setItem("sizeHeight",l.height),localStorage.setItem("sizeKoeff",$),s.imageSmoothingEnabled=!1,x()}function X(){b.classList.remove("cursorPensil"),b.classList.remove("cursorChooseColor"),b.classList.add("cursorPaintBucket"),l.removeEventListener("mousemove",M),l.removeEventListener("mousedown",D),l.addEventListener("mousedown",R)}function Y(){b.classList.remove("cursorPensil"),b.classList.remove("cursorPaintBucket"),b.classList.add("cursorChooseColor"),l.removeEventListener("mousemove",M),l.removeEventListener("mousedown",D),l.removeEventListener("mousedown",R),b.addEventListener("mousedown",z)}function K(){s.lineWidth=p,b.classList.remove("cursorPaintBucket"),b.classList.remove("cursorChooseColor"),b.classList.add("cursorPensil"),l.removeEventListener("mousedown",R),l.addEventListener("mousemove",M),l.addEventListener("mousedown",D)}r.addEventListener("click",t=>{const{target:e}=t,o=e.closest(".table__item");if(!o.classList.contains("table__item_no-use"))if(o.classList.contains("clear-canvas"))E();else{for(let t=0;t<v.length;t+=1)v[t].classList.remove("highlight");o.classList.add("highlight"),o.classList.contains("paint-bucket")&&X(),o.classList.contains("choose-color")&&Y(),o.classList.contains("pensil")&&K()}}),n.addEventListener("click",t=>{const{target:e}=t,o=e.closest(".table__item");if(!o.classList.contains("table__item_rnd_curr")){if(o.classList.contains("js-list-input")&&j(),o.classList.contains("js-list-prev")){const t=localStorage.getItem("prevColor");_=t.split(","),P()}o.classList.contains("js-list-red")&&_.toString()!==["255","0","0","255"].toString()&&(_=["255","0","0","255"],P()),o.classList.contains("js-list-blue")&&_.toString()!==["0","0","255","255"].toString()&&(_=["0","0","255","255"],P())}}),c.addEventListener("click",t=>{const{target:e}=t;if(!e.classList.contains("choose-title")){for(let t=0;t<S.length;t+=1)S[t].classList.remove("highlight");e.classList.add("highlight"),e.classList.contains("x64")&&O(8,"64"),e.classList.contains("x128")&&O(4,"128"),e.classList.contains("x256")&&O(2,"256"),e.classList.contains("x512")&&O(1,"512")}}),l.addEventListener("mouseup",()=>{localStorage.setItem("canvas",l.toDataURL())}),document.addEventListener("keydown",t=>{"KeyP"===t.code&&(u.classList.remove("highlight"),d.classList.remove("highlight"),m.classList.add("highlight"),K()),"KeyB"===t.code&&(m.classList.remove("highlight"),d.classList.remove("highlight"),u.classList.add("highlight"),X()),"KeyC"===t.code&&(u.classList.remove("highlight"),m.classList.remove("highlight"),d.classList.add("highlight"),Y())}),h.addEventListener("change",()=>{j()});var N={initial:function(){if(null===localStorage.getItem("color")?(localStorage.setItem("color","0,0,0,255"),localStorage.setItem("prevColor","255,255,255,0"),s.fillStyle="rgb(0, 0, 0)",s.strokeStyle="rgb(0, 0, 0)",i.style.backgroundColor="rgb(0, 0, 0)"):(_=localStorage.getItem("color").split(","),k=localStorage.getItem("prevColor").split(","),s.fillStyle=`rgb(${_[0]}, ${_[1]}, ${_[2]})`,s.strokeStyle=`rgb(${_[0]}, ${_[1]}, ${_[2]})`,i.style.backgroundColor=`rgb(${_[0]}, ${_[1]}, ${_[2]})`,g.style.backgroundColor=`rgb(${k[0]}, ${k[1]}, ${k[2]})`),null===localStorage.getItem("sizeWidth")||null===localStorage.getItem("sizeHeight"))localStorage.setItem("sizeWidth",128),localStorage.setItem("sizeHeight",128),localStorage.setItem("sizeKoeff",4),l.width="128",l.height="128",$=4,S[1].classList.add("highlight");else{l.width=localStorage.getItem("sizeWidth"),l.height=localStorage.getItem("sizeHeight"),$=+localStorage.getItem("sizeKoeff");for(let t=0;t<S.length;t+=1)S[t].classList.contains(`x${localStorage.getItem("sizeWidth")}`)&&S[t].classList.add("highlight")}l.addEventListener("mouseout",()=>{w=!1,C=!1,I.textContent="X / Y"}),l.addEventListener("mousemove",t=>{C=!0,I.textContent=a(t.offsetX,t.offsetY,$)}),b.addEventListener("mouseup",()=>{w=!1}),s.imageSmoothingEnabled=!1,f.style.backgroundColor="rgb(0, 0, 0)",K(),x()},clearCanvas:E,color:_,ctx:s,canvas:l};const W=document.querySelector(".input-choose-town");var B=function(){if(!W.value)return void alert("Please enter country name");N.clearCanvas(),async function(t){const e=await fetch(t);return await e.json()}(`https://api.unsplash.com/photos/random?query=town,${W.value}&client_id=9e818333317cf17c2e611a148192902ef05d520230c9dca3bb50c35d42dd40d4`).then(t=>{const e=new Image;e.crossOrigin="Anonymous",e.src=t.urls.small,e.onload=()=>{let t,o,a,l,s;e.width>e.height?(a=e.width/N.canvas.width,s=((t=N.canvas.width)-(o=e.height/a))/2,N.ctx.drawImage(e,0,s,t,o)):(a=e.height/N.canvas.height,t=e.width/a,l=((o=N.canvas.height)-t)/2,N.ctx.drawImage(e,l,0,t,o)),localStorage.setItem("canvas",N.canvas.toDataURL()),localStorage.setItem("graduate","true")}})},U=function(){if("false"===localStorage.getItem("graduate"))return void alert("Canvas is empty!");const t=N.ctx.getImageData(0,0,N.canvas.width,N.canvas.height),{data:e}=t;for(let t=0;t<e.length;t+=4){const o=.3*e[t]+.59*e[t+1]+.11*e[t+2];e[t]=o,e[t+1]=o,e[t+2]=o}N.ctx.putImageData(t,0,0),localStorage.setItem("canvas",N.canvas.toDataURL())};const H=document.querySelector(".picture-download"),A=document.querySelector(".black-and-white");N.initial(),H.onclick=B,A.onclick=U},function(t,e){}]);